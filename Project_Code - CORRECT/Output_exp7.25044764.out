/zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT

Running LSTM model with varying error multipliers to analyze impact

================================================================================
Running baseline model with clean data (0x error multiplier)
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_081644.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using clean data for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.963477, Val Loss: 1.014720, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.828298, Val Loss: 0.730404, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.705088, Val Loss: 0.628416, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.618014, Val Loss: 0.593989, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.610784, Val Loss: 0.437337, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.559179, Val Loss: 0.361910, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.517969, Val Loss: 0.418244, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.508081, Val Loss: 0.280836, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.483482, Val Loss: 0.356109, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.457885, Val Loss: 0.282949, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.445147, Val Loss: 0.335752, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.422473, Val Loss: 0.313252, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.446462, Val Loss: 0.316086, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.419716, Val Loss: 0.354583, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.431233, Val Loss: 0.413584, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.414523, Val Loss: 0.284863, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.398501, Val Loss: 0.337276, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.412492, Val Loss: 0.337445, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.280836
Final validation loss: 0.337445
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
122.91          | 95.69           | 0.7216          | 0.280836       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_082402.png
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_082402.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved clean model to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/clean_model.pth

Baseline model with clean data completed!

================================================================================
Running experiment with error multiplier: 0.0x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_082410.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 0.0x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 0.0
  Drift: 0.0
  Flatline: 0.0
  Offset: 0.0
  Noise: 0.0
  Baseline shift: 0.0
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.973466, Val Loss: 0.995113, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.806338, Val Loss: 0.649367, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.713704, Val Loss: 0.567022, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.601068, Val Loss: 0.475040, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.573029, Val Loss: 0.310712, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.533550, Val Loss: 0.413649, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.532684, Val Loss: 0.362744, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.507862, Val Loss: 0.306257, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.498411, Val Loss: 0.313325, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.478272, Val Loss: 0.331116, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.460209, Val Loss: 0.263745, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.468484, Val Loss: 0.335287, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.446596, Val Loss: 0.298752, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.429187, Val Loss: 0.301574, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.415978, Val Loss: 0.292819, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.431449, Val Loss: 0.333454, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.398048, Val Loss: 0.330744, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.400985, Val Loss: 0.297012, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.406756, Val Loss: 0.354957, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.399600, Val Loss: 0.322901, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.375752, Val Loss: 0.301385, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.263745
Final validation loss: 0.301385
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
116.15          | 88.68           | 0.7513          | 0.263745       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_083237.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_083237.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 0.0x error multiplier completed!

================================================================================
Running experiment with error multiplier: 0.0x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_083246.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 0.0x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 0.0
  Drift: 0.0
  Flatline: 0.0
  Offset: 0.0
  Noise: 0.0
  Baseline shift: 0.0
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.958575, Val Loss: 0.999086, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.781581, Val Loss: 0.709643, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.708893, Val Loss: 0.582385, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.608501, Val Loss: 0.552373, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.608478, Val Loss: 0.382697, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.556243, Val Loss: 0.397611, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.523538, Val Loss: 0.322897, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.506624, Val Loss: 0.292980, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.500608, Val Loss: 0.312147, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.480049, Val Loss: 0.373522, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.465752, Val Loss: 0.293150, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.451614, Val Loss: 0.326367, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.431692, Val Loss: 0.277025, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.417531, Val Loss: 0.309569, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.420206, Val Loss: 0.301799, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.408306, Val Loss: 0.313313, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.414085, Val Loss: 0.327794, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.392537, Val Loss: 0.310258, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.389412, Val Loss: 0.310223, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.384265, Val Loss: 0.331230, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.369087, Val Loss: 0.338298, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.372490, Val Loss: 0.316771, LR: 1.00e-03
Epoch 23/50 - Train Loss: 0.369367, Val Loss: 0.369983, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.277025
Final validation loss: 0.369983
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
128.70          | 97.97           | 0.6948          | 0.277025       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_084212.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_084212.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 0.0x error multiplier completed!

================================================================================
Running experiment with error multiplier: 0.1x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_084221.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 0.1x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 0.1
  Drift: 0.1
  Flatline: 0.0
  Offset: 0.1
  Noise: 0.1
  Baseline shift: 0.1
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.964054, Val Loss: 1.021570, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.824813, Val Loss: 0.726857, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.711243, Val Loss: 0.621992, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.620662, Val Loss: 0.619280, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.601599, Val Loss: 0.438409, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.557421, Val Loss: 0.358787, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.530729, Val Loss: 0.465745, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.520579, Val Loss: 0.329008, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.507298, Val Loss: 0.335578, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.497106, Val Loss: 0.424357, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.471375, Val Loss: 0.311716, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.448576, Val Loss: 0.345873, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.428738, Val Loss: 0.296053, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.420847, Val Loss: 0.323938, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.417085, Val Loss: 0.294175, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.394442, Val Loss: 0.349886, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.398184, Val Loss: 0.320183, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.389313, Val Loss: 0.350691, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.374003, Val Loss: 0.317541, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.368582, Val Loss: 0.326585, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.363693, Val Loss: 0.368763, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.383881, Val Loss: 0.338766, LR: 1.00e-03
Epoch 23/50 - Train Loss: 0.386092, Val Loss: 0.459734, LR: 1.00e-03
Epoch 24/50 - Train Loss: 0.373719, Val Loss: 0.379628, LR: 1.00e-03
Epoch 25/50 - Train Loss: 0.352433, Val Loss: 0.339299, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.294175
Final validation loss: 0.339299
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
123.24          | 95.73           | 0.7201          | 0.294175       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_085243.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_085243.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 0.1x error multiplier completed!

================================================================================
Running experiment with error multiplier: 0.1x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_085251.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 0.1x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 0.1
  Drift: 0.1
  Flatline: 0.0
  Offset: 0.1
  Noise: 0.1
  Baseline shift: 0.1
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
No offsets to inject
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
No spikes to inject
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 0 noise periods randomly across entire dataset...
Successfully injected 1 errors randomly across entire dataset
Injected 1 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.971802, Val Loss: 1.017749, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.792841, Val Loss: 0.709165, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.669769, Val Loss: 0.589094, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.594594, Val Loss: 0.497981, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.550346, Val Loss: 0.337652, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.522730, Val Loss: 0.347888, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.506847, Val Loss: 0.299347, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.484841, Val Loss: 0.298912, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.475087, Val Loss: 0.318351, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.455064, Val Loss: 0.300049, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.451361, Val Loss: 0.331267, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.415520, Val Loss: 0.279010, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.457470, Val Loss: 0.461740, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.457332, Val Loss: 0.388759, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.408005, Val Loss: 0.296023, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.400536, Val Loss: 0.364990, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.400566, Val Loss: 0.308704, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.387103, Val Loss: 0.329241, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.372309, Val Loss: 0.359072, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.379249, Val Loss: 0.308725, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.397705, Val Loss: 0.355173, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.384357, Val Loss: 0.357361, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.279010
Final validation loss: 0.357361
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
126.48          | 98.98           | 0.7052          | 0.279010       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_090213.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_090213.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 0.1x error multiplier completed!

================================================================================
Running experiment with error multiplier: 0.5x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_090221.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 0.5x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 0.5
  Drift: 0.5
  Flatline: 0.0
  Offset: 0.5
  Noise: 0.5
  Baseline shift: 0.5
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 6 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 5 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 6 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 6 noise periods randomly across entire dataset...
Successfully injected 23 errors randomly across entire dataset
Injected 23 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 6 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 5 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 6 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 6 noise periods randomly across entire dataset...
Successfully injected 23 errors randomly across entire dataset
Injected 23 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 1 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 1 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 1 noise periods randomly across entire dataset...
Successfully injected 4 errors randomly across entire dataset
Injected 4 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.948719, Val Loss: 0.993247, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.805530, Val Loss: 0.694429, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.694363, Val Loss: 0.620232, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.606667, Val Loss: 0.473147, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.572872, Val Loss: 0.418996, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.522105, Val Loss: 0.336907, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.509347, Val Loss: 0.360305, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.488491, Val Loss: 0.281474, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.484902, Val Loss: 0.331673, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.453186, Val Loss: 0.277798, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.439888, Val Loss: 0.329752, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.426335, Val Loss: 0.314977, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.416608, Val Loss: 0.315612, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.416037, Val Loss: 0.315066, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.420030, Val Loss: 0.372531, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.405827, Val Loss: 0.301156, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.401677, Val Loss: 0.325988, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.387031, Val Loss: 0.334229, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.378334, Val Loss: 0.324246, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.379914, Val Loss: 0.308695, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.277798
Final validation loss: 0.308695
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
117.56          | 90.44           | 0.7453          | 0.277798       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_091030.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_091030.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 0.5x error multiplier completed!

================================================================================
Running experiment with error multiplier: 1.0x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_091043.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 1.0x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 1.0
  Drift: 1.0
  Flatline: 0.0
  Offset: 1.0
  Noise: 1.0
  Baseline shift: 1.0
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 12 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 11 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 12 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 12 noise periods randomly across entire dataset...
Successfully injected 47 errors randomly across entire dataset
Injected 47 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 12 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 11 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 12 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 12 noise periods randomly across entire dataset...
Successfully injected 47 errors randomly across entire dataset
Injected 47 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 2 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 2 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 2 noise periods randomly across entire dataset...
Successfully injected 7 errors randomly across entire dataset
Injected 7 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 2 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 1 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 2 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 2 noise periods randomly across entire dataset...
Successfully injected 7 errors randomly across entire dataset
Injected 7 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.939074, Val Loss: 0.972026, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.787792, Val Loss: 0.679872, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.667660, Val Loss: 0.594921, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.616948, Val Loss: 0.502355, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.650117, Val Loss: 0.437802, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.559166, Val Loss: 0.403173, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.544356, Val Loss: 0.374878, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.529472, Val Loss: 0.333912, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.518013, Val Loss: 0.324418, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.508847, Val Loss: 0.329965, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.484587, Val Loss: 0.360980, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.489551, Val Loss: 0.318734, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.457508, Val Loss: 0.394104, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.462147, Val Loss: 0.299910, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.441177, Val Loss: 0.363004, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.434266, Val Loss: 0.297732, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.422464, Val Loss: 0.306079, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.428736, Val Loss: 0.326566, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.417911, Val Loss: 0.319545, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.406084, Val Loss: 0.355298, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.399521, Val Loss: 0.308965, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.397108, Val Loss: 0.366813, LR: 1.00e-03
Epoch 23/50 - Train Loss: 0.403809, Val Loss: 0.345518, LR: 1.00e-03
Epoch 24/50 - Train Loss: 0.393087, Val Loss: 0.376204, LR: 1.00e-03
Epoch 25/50 - Train Loss: 0.390912, Val Loss: 0.355639, LR: 1.00e-03
Epoch 26/50 - Train Loss: 0.368407, Val Loss: 0.349281, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.297732
Final validation loss: 0.349281
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
125.05          | 95.37           | 0.7118          | 0.297732       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_092116.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_092116.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 1.0x error multiplier completed!

================================================================================
Running experiment with error multiplier: 1.5x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_092134.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 1.5x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 1.5
  Drift: 1.5
  Flatline: 0.0
  Offset: 1.5
  Noise: 1.5
  Baseline shift: 1.5
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 18 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 17 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 18 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 18 noise periods randomly across entire dataset...
Successfully injected 71 errors randomly across entire dataset
Injected 71 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 18 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 17 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 18 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 18 noise periods randomly across entire dataset...
Successfully injected 71 errors randomly across entire dataset
Injected 71 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 3 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 2 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 3 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 3 noise periods randomly across entire dataset...
Successfully injected 11 errors randomly across entire dataset
Injected 11 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 3 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 2 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 3 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 3 noise periods randomly across entire dataset...
Successfully injected 11 errors randomly across entire dataset
Injected 11 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.945205, Val Loss: 0.965308, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.789134, Val Loss: 0.672181, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.678796, Val Loss: 0.594912, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.604774, Val Loss: 0.526697, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.563865, Val Loss: 0.387082, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.575931, Val Loss: 0.360034, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.499690, Val Loss: 0.412100, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.522008, Val Loss: 0.351276, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.493440, Val Loss: 0.304848, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.476416, Val Loss: 0.377094, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.448538, Val Loss: 0.339318, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.454280, Val Loss: 0.361224, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.442669, Val Loss: 0.293445, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.425452, Val Loss: 0.390089, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.419433, Val Loss: 0.340223, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.420046, Val Loss: 0.317368, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.412683, Val Loss: 0.372316, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.406074, Val Loss: 0.320323, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.418444, Val Loss: 0.375931, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.385552, Val Loss: 0.304419, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.394144, Val Loss: 0.422579, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.390940, Val Loss: 0.356156, LR: 1.00e-03
Epoch 23/50 - Train Loss: 0.365151, Val Loss: 0.372699, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.293445
Final validation loss: 0.372699
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
129.17          | 101.63          | 0.6925          | 0.293445       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_093112.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_093112.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 1.5x error multiplier completed!

================================================================================
Running experiment with error multiplier: 2.0x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_093134.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 2.0x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 2.0
  Drift: 2.0
  Flatline: 0.0
  Offset: 2.0
  Noise: 2.0
  Baseline shift: 2.0
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 24 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 23 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 24 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 24 noise periods randomly across entire dataset...
Successfully injected 95 errors randomly across entire dataset
Injected 95 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 24 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 23 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 24 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 24 noise periods randomly across entire dataset...
Successfully injected 95 errors randomly across entire dataset
Injected 95 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 4 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 3 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 4 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 4 noise periods randomly across entire dataset...
Successfully injected 15 errors randomly across entire dataset
Injected 15 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 4 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 3 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 4 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 4 noise periods randomly across entire dataset...
Successfully injected 15 errors randomly across entire dataset
Injected 15 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.936169, Val Loss: 0.958608, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.765761, Val Loss: 0.703803, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.664374, Val Loss: 0.603978, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.588739, Val Loss: 0.502271, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.572350, Val Loss: 0.380710, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.556065, Val Loss: 0.381070, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.536354, Val Loss: 0.417416, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.518416, Val Loss: 0.319820, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.497454, Val Loss: 0.376834, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.480627, Val Loss: 0.371208, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.471522, Val Loss: 0.314234, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.473659, Val Loss: 0.368601, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.447997, Val Loss: 0.318339, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.440190, Val Loss: 0.370782, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.439150, Val Loss: 0.340042, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.424066, Val Loss: 0.386344, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.413305, Val Loss: 0.311375, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.412806, Val Loss: 0.416808, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.409524, Val Loss: 0.354316, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.401513, Val Loss: 0.370684, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.394720, Val Loss: 0.398883, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.383847, Val Loss: 0.359979, LR: 1.00e-03
Epoch 23/50 - Train Loss: 0.386913, Val Loss: 0.460457, LR: 1.00e-03
Epoch 24/50 - Train Loss: 0.373350, Val Loss: 0.363333, LR: 1.00e-03
Epoch 25/50 - Train Loss: 0.367915, Val Loss: 0.406621, LR: 1.00e-03
Epoch 26/50 - Train Loss: 0.384860, Val Loss: 0.524027, LR: 1.00e-03
Epoch 27/50 - Train Loss: 0.377136, Val Loss: 0.435050, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.311375
Final validation loss: 0.435050
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
139.57          | 107.31          | 0.6410          | 0.311375       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_094258.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_094258.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 2.0x error multiplier completed!

================================================================================
Running experiment with error multiplier: 3.0x
================================================================================

Processing data for station 21006846...
dict_keys(['21006845', '21006846', '21006847'])
dict_keys(['vst_raw', 'vst_edt', 'vinge', 'rainfall', 'temperature', 'vst_raw_feature'])

Input Features Summary:
----------------------
Base features:
  - rainfall
  - temperature

Feature stations:
  - Station 21006845:
    * vst_raw
    * rainfall
    * temperature
  - Station 21006847:
    * vst_raw
    * rainfall

Feature engineering settings:
  - Using time features: False
  - Using cumulative features: True
----------------------

  - Aggregated temperature to 30 days

Split Summary:
Training period: 2010 - 2021
Validation period: 2022 - 2023
Test year: 2024

Data shapes:
Total data: (526273, 20)
Train data: (420480, 20)
Validation data: (70080, 20)
Test data: (35136, 20)
Limiting feature plot to the most recent 10 years: 2011-12-31 to 2021-12-31
Saved station features plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots/station_features_20250523_094326.png
Generated feature plots in /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/feature_plots
Skipping preprocessing diagnostics generation...

Step 2: Generating synthetic errors...

Injecting synthetic errors with multiplier 3.0x into TRAINING and VALIDATION data...
Error counts per year by type:
  Spike: 3.0
  Drift: 3.0
  Flatline: 0.0
  Offset: 3.0
  Noise: 3.0
  Baseline shift: 3.0
  Missing_data: 0.0
Injecting errors into columns: ['feature_station_21006847_vst_raw', 'feature_station_21006845_vst_raw']

Processing TRAINING data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 36 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 35 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 36 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 36 noise periods randomly across entire dataset...
Successfully injected 143 errors randomly across entire dataset
Injected 143 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 12.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 12.0 years
Attempting to inject 36 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 35 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 12.0 years
Attempting to inject 36 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 12.0 years
Attempting to inject 36 noise periods randomly across entire dataset...
Successfully injected 143 errors randomly across entire dataset
Injected 143 error periods into feature_station_21006845_vst_raw

Processing VALIDATION data...

Processing feature_station_21006847_vst_raw...
Generating synthetic errors for feature_station_21006847_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 6 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 5 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 6 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 6 noise periods randomly across entire dataset...
Successfully injected 23 errors randomly across entire dataset
Injected 23 error periods into feature_station_21006847_vst_raw

Processing feature_station_21006845_vst_raw...
Generating synthetic errors for feature_station_21006845_vst_raw...
Data spans approximately 2.0 years
Active error types: ['offset', 'drift', 'spike', 'noise']
Injecting offset errors...
Data spans approximately 2.0 years
Attempting to inject 6 offset periods randomly across entire dataset...
Injecting drift errors...
Attempting to inject 5 drifts randomly across entire dataset...
Injecting spike errors...
Data spans approximately 2.0 years
Attempting to inject 6 spikes randomly across entire dataset...
Injecting noise errors...
Data spans approximately 2.0 years
Attempting to inject 6 noise periods randomly across entire dataset...
Successfully injected 23 errors randomly across entire dataset
Injected 23 error periods into feature_station_21006845_vst_raw

Synthetic error injection complete.
Created datasets with synthetic errors in 2 feature columns
Skipping synthetic error diagnostics generation...

Step 3: Training LSTM models...

Initializing model...
Creating model with sequence_length: 70080

Verifying hyperparameters:
  hidden_size: 128
  num_layers: 2
  dropout: 0.25
  learning_rate: 0.001
  batch_size: 1
  sequence_length: 70080

Using data with synthetic errors for training

Training model...
Train data length: 420480
Validation data length: 70080
Epoch 1/50 - Train Loss: 0.942335, Val Loss: 0.961115, LR: 1.00e-03
Epoch 2/50 - Train Loss: 0.784559, Val Loss: 0.709687, LR: 1.00e-03
Epoch 3/50 - Train Loss: 0.697043, Val Loss: 0.619315, LR: 1.00e-03
Epoch 4/50 - Train Loss: 0.629969, Val Loss: 0.621395, LR: 1.00e-03
Epoch 5/50 - Train Loss: 0.602339, Val Loss: 0.411568, LR: 1.00e-03
Epoch 6/50 - Train Loss: 0.558897, Val Loss: 0.365623, LR: 1.00e-03
Epoch 7/50 - Train Loss: 0.542436, Val Loss: 0.362723, LR: 1.00e-03
Epoch 8/50 - Train Loss: 0.536715, Val Loss: 0.383820, LR: 1.00e-03
Epoch 9/50 - Train Loss: 0.499961, Val Loss: 0.363392, LR: 1.00e-03
Epoch 10/50 - Train Loss: 0.504237, Val Loss: 0.328800, LR: 1.00e-03
Epoch 11/50 - Train Loss: 0.484862, Val Loss: 0.365958, LR: 1.00e-03
Epoch 12/50 - Train Loss: 0.449870, Val Loss: 0.317221, LR: 1.00e-03
Epoch 13/50 - Train Loss: 0.461447, Val Loss: 0.369543, LR: 1.00e-03
Epoch 14/50 - Train Loss: 0.453493, Val Loss: 0.339781, LR: 1.00e-03
Epoch 15/50 - Train Loss: 0.450748, Val Loss: 0.363417, LR: 1.00e-03
Epoch 16/50 - Train Loss: 0.445823, Val Loss: 0.367534, LR: 1.00e-03
Epoch 17/50 - Train Loss: 0.455562, Val Loss: 0.358138, LR: 1.00e-03
Epoch 18/50 - Train Loss: 0.422355, Val Loss: 0.333152, LR: 1.00e-03
Epoch 19/50 - Train Loss: 0.413061, Val Loss: 0.384031, LR: 1.00e-03
Epoch 20/50 - Train Loss: 0.411703, Val Loss: 0.389653, LR: 1.00e-03
Epoch 21/50 - Train Loss: 0.430052, Val Loss: 0.381732, LR: 1.00e-03
Epoch 22/50 - Train Loss: 0.425375, Val Loss: 0.452808, LR: 1.00e-03
Early stopping triggered!

Training Results:
Best validation loss: 0.317221
Final validation loss: 0.452808
Model saved to final_model.pth
Original validation predictions shape: (1, 70080, 1)
Flattening 3-dimensional array
Reshaped to: (1, 70080)
Final flattened shape: (70080,)
Validation predictions length: 70080
Validation data length: 70080

Model Performance Metrics:
--------------------------------------------------------------------------------
RMSE            | MAE             | NSE             | Val Loss       
--------------------------------------------------------------------------------
142.40          | 110.60          | 0.6263          | 0.317221       
--------------------------------------------------------------------------------
Length of test_actual: 70080
Length of predictions: 70080
Saved water level PNG plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/water_level_station_21006846_20250523_095241.png
Creating focused error period PNG plots for up to 2 of each error type...
Opening plot in browser: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/predictions_station_21006846_20250523_095241.html
Saved convergence plot to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/lstm/convergence_plot_21006846.png

Saved cumulative results to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_results.csv

Experiment with 3.0x error multiplier completed!

All experiments completed!

Summary of Results:
================================================================================
   error_multiplier  clean_rmse  error_rmse  ...   error_mae  clean_nse  error_nse
0             0.001  122.913287  116.154310  ...   88.677002   0.721563   0.751343
1             0.010  122.913287  128.695343  ...   97.972110   0.721563   0.694750
2             0.050  122.913287  123.240832  ...   95.733387   0.721563   0.720077
3             0.100  122.913287  126.479666  ...   98.980713   0.721563   0.705170
4             0.500  122.913287  117.559921  ...   90.440057   0.721563   0.745289
5             1.000  122.913287  125.054341  ...   95.369090   0.721563   0.711778
6             1.500  122.913287  129.166554  ...  101.626770   0.721563   0.692511
7             2.000  122.913287  139.573166  ...  107.310969   0.721563   0.640968
8             3.000  122.913287  142.395887  ...  110.596364   0.721563   0.626299

[9 rows x 7 columns]

Performance Degradation:
================================================================================
   error_multiplier  rmse_pct_increase  mae_pct_increase  nse_pct_decrease
0             0.001          -5.498980         -7.328300         -4.127217
1             0.010           4.704175          2.385531          3.715895
2             0.050           0.266484          0.045958          0.205937
3             0.100           2.901540          3.439569          2.271785
4             0.500          -4.355400         -5.485824         -3.288132
5             1.000           1.741922         -0.334750          1.356058
6             1.500           5.087543          6.204825          4.026249
7             2.000          13.554172         12.145084         11.169515
8             3.000          15.850687         15.578479         13.202457

Saved error multiplier impact visualization to: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_impact.png

Created summary HTML file at: /zhome/ff/b/147446/MasterThesis/Project_Code - CORRECT/results/error_multiplier_summary.html
